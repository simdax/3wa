

mixin alreadyLogged(name)
  b-navbar#menu(toggleable type="inverse")
    b-nav-toggle(target="nav")
    b-link.navbar-brand(href='/') salut #{name}
    b-collapse#nav(is-nav)
      b-nav.ml-auto(is-nav-bar)
        b-nav-item-dropdown(right-alignment)
          b-dropdown-item(href="/defis" )  voir les defis
          b-dropdown-item(href="/users" )  see users
          b-dropdown-item(href="/upload") upload a file
          b-dropdown-item(href="/logOut") log out
  script.
    new Vue({el:'#menu'})



mixin homeForm(legend="inscris-toi mec, juste pour le plaisir de faire du firebase !",dejaInscrit=true)
  .fixedDiv
  if (!logged)
    #auth
      form(@submit.prevent="submit($event)" action="../signUp",method="post")
        fieldset
          legend= legend
          input(:style="style2" v-model="name" type="text" placeholder="ton nom" name="nom" required)
          input(title="prout" v-model="mail" type="mail" placeholder="ton mail" name="mail" required :style="style")
          input(type="submit" value="Mais ouais !") 
      if dejaInscrit
        form(action="../signIn",method="post")
          fieldset
            legend Ou alors t'es déjà tellement inscrit, c'est chaud !
            input(type="mail" placeholder="ton mail" name="mail" required)
            input(type="submit" value="Mais ouais, encore plus !") 
    script(src="javascripts/auth.js")
  else
    .alreadyLogged
      +alreadyLogged(name)


mixin fileTransfert
  .fixedDivBottom
  form#dirUpload(action="upload/dir" method="post" enctype="multipart/form-data")
    input#dir(type="file" name="dir" multiple webkitdirectory)
    input(type="submit")
  script.
    var  output = [];
    document.getElementById("dir").addEventListener("change", function(event) {
      var  files = event.target.files;
      for (var  i=0; i<files.length; i++) {
        var  item = files[i].webkitRelativePath;
        output.push(item);
      };
      console.log(output);
    }, false);  
    document.getElementById("dirUpload").addEventListener("submit",function(ev){
      ev.preventDefault();
        var input = $("<input>").attr("type", "hidden").attr("name", "io").val(output);
        $(ev.target).append($(input));
        ev.target.submit()
    })

  #uploadForm
    form(action="newFile", method="post", enctype="multipart/form-data")
      #buttons
        label(for="html") HTML
        input(type="file", id="html", name="html")
        label(for="css") CSS
        input(type="file", id="css", name="css")
        label(for="js") JAVASCRIPT
        input(type="file", id="js", name="js")
      #ok
        input(type="submit" value="vazi, fiston, c'est ton heure de gloire !")